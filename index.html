<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PDF Merger Pro | The Ultimate PDF Merger</title>
    <script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* --- CSS Variables for Theming --- */
        :root {
            --bg-color: #f0f2f5;
            --bg-gradient-start: #e0e7ff;
            --bg-gradient-end: #f0f2f5;
            /* GLASSMORPHISM ENHANCEMENT: Increased transparency for a stronger blur effect */
            --container-bg: rgba(255, 255, 255, 0.75);
            --text-primary: #111827;
            --text-secondary: #4b5563;
            --text-tertiary: #6b7280;
            --primary-color: #4f46e5;
            --primary-color-hover: #4338ca;
            --success-color: #059669;
            --danger-color: #dc2626;
            --upload-bg: #f9fafb;
            --upload-border: #d1d5db;
            --upload-border-drag: var(--primary-color);
            --upload-bg-drag: #eef2ff;
            --file-item-bg: #ffffff;
            --file-item-border: #e5e7eb;
            --file-item-shadow: rgba(0, 0, 0, 0.05);
            --shadow-lg: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            --shadow-md: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --backdrop-blur: 20px; /* GLASSMORPHISM ENHANCEMENT: Slightly increased blur */
        }

        [data-theme="dark"] {
            --bg-color: #111827;
            --bg-gradient-start: #111827;
            --bg-gradient-end: #1f2937;
            /* GLASSMORPHISM ENHANCEMENT: Increased transparency for a stronger blur effect */
            --container-bg: rgba(31, 41, 55, 0.6);
            --text-primary: #f9fafb;
            --text-secondary: #d1d5db;
            --text-tertiary: #9ca3af;
            --upload-bg: #1f2937;
            --upload-border: #4b5563;
            --file-item-bg: #374151;
            --file-item-border: #4b5563;
        }

        /* --- Animations --- */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes popIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }

        /* --- Base & Typography --- */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-color);
            background-image: linear-gradient(145deg, var(--bg-gradient-start) 0%, var(--bg-gradient-end) 100%);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            color: var(--text-secondary);
            transition: background-color 0.3s ease;
        }

        /* --- Layout & Main Container --- */
        .main-wrapper {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            animation: fadeIn 0.5s ease-out;
        }
        .container {
            /* GLASSMORPHISM ENHANCEMENT: Added a gradient sheen for a more realistic glass effect */
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.1), transparent), var(--container-bg);
            backdrop-filter: blur(var(--backdrop-blur));
            -webkit-backdrop-filter: blur(var(--backdrop-blur));
            max-width: 720px;
            width: 100%;
            padding: 40px;
            border-radius: 24px;
            box-shadow: var(--shadow-lg);
             /* GLASSMORPHISM ENHANCEMENT: A universal, semi-transparent border for the "milky edge" look */
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }
        .header { text-align: center; margin-bottom: 30px; position: relative; }
        .header h1 {
            color: var(--text-primary);
            font-size: 2.5rem;
            font-weight: 700;
        }
        .header p { color: var(--text-tertiary); font-size: 1.1rem; margin-top: 8px; }

        /* --- Theme Toggle --- */
        .theme-switcher {
            position: absolute;
            top: -15px;
            right: -15px;
            background: var(--file-item-bg);
            border-radius: 99px;
            padding: 4px;
            display: flex;
            border: 1px solid var(--file-item-border);
        }
        .theme-switcher button {
            background: transparent;
            border: none;
            color: var(--text-tertiary);
            cursor: pointer;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            transition: all 0.2s ease;
        }
        .theme-switcher button.active {
            background: var(--primary-color);
            color: white;
        }

        /* --- File Upload Section --- */
        .upload-section { margin-bottom: 24px; }
        .file-upload-wrapper { position: relative; }
        .file-upload-input { position: absolute; opacity: 0; width: 100%; height: 100%; cursor: pointer; }
        .file-upload-button {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 12px;
            width: 100%;
            padding: 32px;
            background-color: var(--upload-bg);
            color: var(--text-secondary);
            border: 2px dashed var(--upload-border);
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .file-upload-button .upload-icon { color: var(--primary-color); font-size: 2.5rem; }
        .file-upload-button:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-md);
            border-color: var(--primary-color);
        }
        .file-upload-button.dragover {
            border-color: var(--upload-border-drag);
            background: var(--upload-bg-drag);
            transform: scale(1.02);
        }
        
        /* --- File List Section --- */
        .file-list-container {
            background-color: var(--upload-bg);
            border-radius: 16px;
            padding: 24px;
            margin-top: 20px;
            border: 1px solid var(--file-item-border);
            animation: fadeIn 0.4s ease-out;
        }
        .file-list-header {
            color: var(--text-primary);
            margin-bottom: 15px;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        #file-summary { font-size: 0.9rem; font-weight: 500; color: var(--text-tertiary); }

        .file-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px;
            background: var(--file-item-bg);
            border-radius: 10px;
            margin-bottom: 10px;
            border: 1px solid var(--file-item-border);
            transition: all 0.2s ease;
            cursor: grab;
            animation: popIn 0.3s ease-out;
        }
        .file-item:last-child { margin-bottom: 0; }
        .file-item:hover { box-shadow: 0 0 0 2px var(--primary-color); border-color: transparent; }
        .file-item.dragging { opacity: 0.6; background: #eef2ff; cursor: grabbing; }

        .file-info { display: flex; align-items: center; gap: 12px; }
        .file-icon { color: var(--danger-color); font-size: 1.4rem; }
        .file-details { display: flex; flex-direction: column; }
        .file-name { color: var(--text-primary); font-weight: 600; }
        .file-meta { color: var(--text-tertiary); font-size: 0.85rem; margin-top: 2px; }
        .file-actions button {
            background: transparent;
            color: var(--text-tertiary);
            border: none;
            width: 28px; height: 28px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex; align-items: center; justify-content: center;
        }
        .file-actions button:hover { background: #fee2e2; color: var(--danger-color); }
        [data-theme="dark"] .file-actions button:hover { background: #4b5563; }

        /* --- Actions & Download Section --- */
        .actions {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }
        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            text-decoration: none;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .btn:hover:not(:disabled) { transform: translateY(-2px); box-shadow: var(--shadow-md); }
        .btn:active:not(:disabled) { transform: translateY(0); }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; box-shadow: none; }

        .btn-primary { background-color: var(--primary-color); color: white; }
        .btn-primary:hover:not(:disabled) { background-color: var(--primary-color-hover); }
        .btn-success { background-color: var(--success-color); color: white; }
        .btn-reset { background-color: #6b7280; color: white; }

        .download-options {
            display: none;
            flex-direction: column;
            gap: 10px;
            width: 100%;
            margin-top: 20px;
            padding: 20px;
            background: var(--upload-bg);
            border-radius: 12px;
            animation: fadeIn 0.3s;
        }
        .download-options label { font-weight: 600; color: var(--text-primary); margin-bottom: 5px; }
        .filename-input {
            width: 100%;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid var(--upload-border);
            background: var(--file-item-bg);
            color: var(--text-primary);
            font-size: 1rem;
        }
        .filename-input:focus { outline: none; box-shadow: 0 0 0 2px var(--primary-color); }

        /* --- Progress & Status --- */
        .progress-bar {
            width: 100%; height: 8px;
            background: var(--file-item-border);
            border-radius: 4px; overflow: hidden; margin: 20px 0; display: none;
        }
        .progress-fill {
            height: 100%;
            background-color: var(--primary-color);
            width: 0%;
            transition: width 0.4s ease-in-out;
        }
        .status-message {
            text-align: center; margin: 15px 0; padding: 12px;
            border-radius: 8px; font-weight: 500; display: none;
        }
        .status-success { background: #dcfce7; color: #15803d; }
        .status-error { background: #fee2e2; color: #b91c1c; }
        [data-theme="dark"] .status-success { background: #14532d; color: #bef264; }
        [data-theme="dark"] .status-error { background: #7f1d1d; color: #fecaca; }

        /* --- Footer --- */
        .footer { text-align: center; padding-top: 40px; }
        .footer .made-with-love { font-weight: 500; font-size: 1rem; color: var(--text-secondary); }
        .footer .copyright { font-size: 0.85rem; opacity: 0.75; color: var(--text-tertiary); margin-top: 5px; }

        /* --- Responsive Design --- */
        @media (max-width: 640px) {
            body { padding: 10px; }
            .container { padding: 20px; margin: 10px; }
            .header h1 { font-size: 2rem; }
            .actions { flex-direction: column; }
            .btn { justify-content: center; width: 100%; }
        }
    </style>
</head>
<body data-theme="light">
    <div class="main-wrapper">
        <div class="container">
            <div class="header">
                <div class="theme-switcher">
                    <button id="light-mode-btn" aria-label="Switch to light mode"><i class="fas fa-sun"></i></button>
                    <button id="dark-mode-btn" aria-label="Switch to dark mode"><i class="fas fa-moon"></i></button>
                </div>
                <h1><i class="fas fa-rocket" style="color: var(--primary-color);"></i> PDF Merger Pro</h1>
                <p>The smarter way to combine, reorder, and manage your PDFs.</p>
            </div>

            <div class="upload-section">
                <div class="file-upload-wrapper">
                    <input type="file" id="pdf-upload" class="file-upload-input" multiple accept="application/pdf" />
                    <label class="file-upload-button" id="upload-button" for="pdf-upload">
                        <i class="fas fa-file-import upload-icon"></i>
                        <div style="text-align: center;">
                            <div style="font-weight: 700; font-size: 1.2rem;">Drag & drop files here</div>
                            <div style="font-size: 0.9rem; opacity: 0.8; margin-top: 4px;">or click to browse</div>
                        </div>
                    </label>
                </div>
            </div>

            <div id="file-list-container" style="display: none;">
                <div class="file-list-header">
                    <span><i class="fas fa-list-check"></i> Your Files</span>
                    <span id="file-summary"></span>
                </div>
                <div id="file-list"></div>
            </div>

            <div class="progress-bar" id="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>
            <div class="status-message" id="status-message" aria-live="polite"></div>

            <div class="actions">
                <button class="btn btn-reset" id="reset-btn" style="display: none;">
                    <i class="fas fa-times"></i> Clear All
                </button>
                <button class="btn btn-primary" id="merge-btn" disabled>
                    <i class="fas fa-wand-magic-sparkles"></i> Merge PDFs
                </button>
            </div>
            
            <div class="download-options" id="download-options">
                <label for="output-filename">Download As</label>
                <input type="text" id="output-filename" class="filename-input" value="Merger-merged.pdf">
                <a class="btn btn-success" id="download-link" style="justify-content: center;">
                    <i class="fas fa-download"></i> Download Merged PDF
                </a>
            </div>
        </div>
    </div>

    <div class="footer">
        <p class="made-with-love">Made with ❤️ by Devesh</p>
        <p class="copyright">&copy; 2025 PDF Merger Pro. All rights reserved.</p>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    // --- DOM Elements ---
    const uploadInput = document.getElementById('pdf-upload');
    const uploadButton = document.getElementById('upload-button');
    const fileListContainer = document.getElementById('file-list-container');
    const fileListDiv = document.getElementById('file-list');
    const fileSummary = document.getElementById('file-summary');
    const mergeBtn = document.getElementById('merge-btn');
    const resetBtn = document.getElementById('reset-btn');
    const downloadOptions = document.getElementById('download-options');
    const downloadLink = document.getElementById('download-link');
    const outputFilenameInput = document.getElementById('output-filename');
    const progressBar = document.getElementById('progress-bar');
    const progressFill = document.getElementById('progress-fill');
    const statusMessage = document.getElementById('status-message');
    const lightModeBtn = document.getElementById('light-mode-btn');
    const darkModeBtn = document.getElementById('dark-mode-btn');

    // --- State ---
    let pdfFiles = [];
    let objectUrl = null;

    // --- Theming ---
    const applyTheme = (theme) => {
        document.body.dataset.theme = theme;
        localStorage.setItem('pdf-Merger-theme', theme);
        lightModeBtn.classList.toggle('active', theme === 'light');
        darkModeBtn.classList.toggle('active', theme === 'dark');
    };
    lightModeBtn.addEventListener('click', () => applyTheme('light'));
    darkModeBtn.addEventListener('click', () => applyTheme('dark'));
    const savedTheme = localStorage.getItem('pdf-Merger-theme') || 'light';
    applyTheme(savedTheme);
    
    // --- Event Listeners ---
    uploadInput.addEventListener('change', handleFileSelect);
    uploadButton.addEventListener('dragover', (e) => { e.preventDefault(); uploadButton.classList.add('dragover'); });
    uploadButton.addEventListener('dragleave', () => uploadButton.classList.remove('dragover'));
    uploadButton.addEventListener('drop', handleFileDrop);
    resetBtn.addEventListener('click', resetState);
    mergeBtn.addEventListener('click', mergePdfs);
    outputFilenameInput.addEventListener('input', updateDownloadFilename);
    fileListDiv.addEventListener('dragstart', handleDragStart);
    fileListDiv.addEventListener('dragover', handleDragOver);
    fileListDiv.addEventListener('drop', handleDropReorder);

    // --- Core Functions ---
    async function handleFileSelect(e) { await addFiles(e.target.files); }
    async function handleFileDrop(e) {
        e.preventDefault();
        uploadButton.classList.remove('dragover');
        await addFiles(e.dataTransfer.files);
    }

    async function addFiles(files) {
        const newPdfFiles = Array.from(files).filter(file => file.type === 'application/pdf' && !pdfFiles.some(pf => pf.file.name === file.name && pf.file.size === file.size));
        if (newPdfFiles.length === 0) return;

        showStatus('Processing new files...', 'info');
        const filePromises = newPdfFiles.map(async file => {
            try {
                const arrayBuffer = await file.arrayBuffer();
                const pdfDoc = await PDFLib.PDFDocument.load(arrayBuffer, { ignoreEncryption: true });
                return { file, pageCount: pdfDoc.getPageCount() };
            } catch (e) {
                showStatus(`Could not process '${file.name}'. It might be corrupted.`, 'error');
                return null;
            }
        });

        const processedFiles = (await Promise.all(filePromises)).filter(Boolean);
        pdfFiles.push(...processedFiles);
        renderFileList();
        updateUI();
        statusMessage.style.display = 'none';
    }
    
    function removeFile(index) {
        pdfFiles.splice(index, 1);
        renderFileList();
        updateUI();
    }

    async function mergePdfs() {
        if (pdfFiles.length < 2) return;
        setLoadingState(true);
        updateProgress(0);
        progressBar.style.display = 'block';

        try {
            const mergedPdf = await PDFLib.PDFDocument.create();
            for (let i = 0; i < pdfFiles.length; i++) {
                const { file } = pdfFiles[i];
                updateProgress(((i + 1) / pdfFiles.length) * 90);
                const arrayBuffer = await file.arrayBuffer();
                const pdf = await PDFLib.PDFDocument.load(arrayBuffer, { ignoreEncryption: true });
                const copiedPages = await mergedPdf.copyPages(pdf, pdf.getPageIndices());
                copiedPages.forEach(page => mergedPdf.addPage(page));
            }

            updateProgress(95);
            const mergedPdfBytes = await mergedPdf.save();
            updateProgress(100);

            const blob = new Blob([mergedPdfBytes], { type: 'application/pdf' });
            if (objectUrl) URL.revokeObjectURL(objectUrl);
            objectUrl = URL.createObjectURL(blob);

            downloadLink.href = objectUrl;
            showStatus(`Successfully merged ${pdfFiles.length} files!`, 'success');
            updateUI();
        } catch (error) {
            console.error('Merge failed:', error);
            showStatus(`Error: ${error.message}`, 'error');
        } finally {
            setLoadingState(false);
            setTimeout(() => { progressBar.style.display = 'none'; }, 2000);
        }
    }

    // --- UI & State Management ---
    function renderFileList() {
        fileListDiv.innerHTML = '';
        if (pdfFiles.length === 0) {
            fileListContainer.style.display = 'none';
            return;
        }
        fileListContainer.style.display = 'block';
        
        let totalPages = 0;
        pdfFiles.forEach((pdfFile, index) => {
            totalPages += pdfFile.pageCount;
            const fileSize = (pdfFile.file.size / 1024 / 1024).toFixed(2);
            const fileItem = document.createElement('div');
            fileItem.className = 'file-item';
            fileItem.draggable = true;
            fileItem.dataset.index = index;
            fileItem.innerHTML = `
                <div class="file-info">
                    <i class="fas fa-grip-vertical" style="color:var(--text-tertiary); cursor:grab;"></i>
                    <i class="fas fa-file-pdf file-icon"></i>
                    <div class="file-details">
                        <span class="file-name">${pdfFile.file.name}</span>
                        <span class="file-meta">${pdfFile.pageCount} pages &bull; ${fileSize} MB</span>
                    </div>
                </div>
                <div class="file-actions">
                    <button aria-label="Remove ${pdfFile.file.name}" onclick="window.removeFileHandler(${index})">
                        <i class="fas fa-trash-alt"></i>
                    </button>
                </div>`;
            fileListDiv.appendChild(fileItem);
        });
        fileSummary.textContent = `${pdfFiles.length} files | ${totalPages} pages total`;
    }

    function updateUI() {
        const hasFiles = pdfFiles.length > 0;
        const canMerge = pdfFiles.length >= 2;
        
        mergeBtn.disabled = !canMerge;
        resetBtn.style.display = hasFiles || objectUrl ? 'flex' : 'none';
        
        if (objectUrl) {
            downloadOptions.style.display = 'flex';
            updateDownloadFilename();
        } else {
            downloadOptions.style.display = 'none';
        }
    }

    function resetState() {
        pdfFiles = [];
        uploadInput.value = '';
        renderFileList();
        if (objectUrl) {
            URL.revokeObjectURL(objectUrl);
            objectUrl = null;
        }
        statusMessage.style.display = 'none';
        progressBar.style.display = 'none';
        updateProgress(0);
        setLoadingState(false);
        updateUI();
        showStatus('Application has been reset.', 'success');
    }
    
    function updateDownloadFilename() {
        let filename = outputFilenameInput.value.trim();
        if (!filename) filename = 'Merger-merged';
        if (!filename.toLowerCase().endsWith('.pdf')) filename += '.pdf';
        downloadLink.download = filename;
    }

    function setLoadingState(isLoading) {
        mergeBtn.disabled = isLoading;
        if (isLoading) {
            mergeBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Merging...';
        } else {
            mergeBtn.innerHTML = '<i class="fas fa-wand-magic-sparkles"></i> Merge PDFs';
            mergeBtn.disabled = pdfFiles.length < 2;
        }
    }
    
    function showStatus(message, type) {
        statusMessage.textContent = message;
        statusMessage.className = `status-message status-${type}`;
        statusMessage.style.display = 'block';
    }

    function updateProgress(percent) { progressFill.style.width = `${percent}%`; }

    // --- Drag and Drop Reordering ---
    let dragStartIndex;
    function handleDragStart(e) { if (e.target.classList.contains('file-item')) { dragStartIndex = +e.target.dataset.index; e.target.classList.add('dragging'); } }
    function handleDragOver(e) { e.preventDefault(); const draggingItem = document.querySelector('.dragging'); if (!draggingItem) return; const afterElement = getDragAfterElement(fileListDiv, e.clientY); if (afterElement == null) { fileListDiv.appendChild(draggingItem); } else { fileListDiv.insertBefore(draggingItem, afterElement); } }
    function handleDropReorder(e) { e.preventDefault(); const draggingItem = document.querySelector('.dragging'); if (!draggingItem) return; draggingItem.classList.remove('dragging'); const newIndex = Array.from(fileListDiv.children).indexOf(draggingItem); if (newIndex !== dragStartIndex) { const [movedItem] = pdfFiles.splice(dragStartIndex, 1); pdfFiles.splice(newIndex, 0, movedItem); } renderFileList(); }
    function getDragAfterElement(container, y) { const draggableElements = [...container.querySelectorAll('.file-item:not(.dragging)')]; return draggableElements.reduce((closest, child) => { const box = child.getBoundingClientRect(); const offset = y - box.top - box.height / 2; if (offset < 0 && offset > closest.offset) { return { offset: offset, element: child }; } else { return closest; } }, { offset: Number.NEGATIVE_INFINITY }).element; }

    window.removeFileHandler = removeFile;
});
</script>
</body>
</html>